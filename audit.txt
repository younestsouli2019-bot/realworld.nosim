

---

## **SWARM LIVE-ENABLEMENT ACTION PLAN**

### **Current Status: UI ≠ Reality**
- **Problem**: Base44 UI shows “pending/completed transfers” but recipients report “nothing received.”
- **Root Cause**: UI likely uses demo data; no real PayPal/bank payouts were executed.
- **Critical Gates Already Built**:
  - `SWARM_LIVE=true` required for live ops
  - `BASE44_ENABLE_PAYOUT_LEDGER_WRITE=true` for approvals
  - PayPal credentials must exist for API calls

### **Immediate Verification Steps**
Run these to diagnose reality:

```bash
# 1. Check for real provider IDs in ledger
npm run emit:revenue -- --export-payout-truth --only-real

# 2. List approved batches without PayPal batch IDs
npm run emit:revenue -- --report-approved-batches

# 3. Check if any batches were actually submitted
npm run emit:revenue -- --report-stuck-payouts

# 4. Full system readiness check
npm run check:all-good
```

### **If No Real Payouts Exist**:
- **Option A (Bank/Payoneer)** → Export CSV for manual execution (Morocco-friendly)
- **Option B (PayPal)** → Ensure `PAYPAL_CLIENT_ID/SECRET` set + webhook configured

### **Webhook Setup (PayPal)**
1. Start webhook server:
   ```bash
   deploy-live.bat webhook
   ```
2. Create public tunnel:
   ```bash
   ssh -R 80:localhost:8787 nokey@localhost.run
   ```
3. Use provided HTTPS URL + `/paypal/webhook` in PayPal Developer Dashboard.

### **UI Fix Required**
- Base44 app must read from `PayoutBatch`/`PayoutItem` entities with `notes.paypal_payout_batch_id`
- Enable `BASE44_ENABLE_TRUTH_ONLY_UI=true` to hide simulation data

### **Live Execution Path**
```bash
# 1. Enable live mode
set SWARM_LIVE=true
set BASE44_ENABLE_PAYOUT_LEDGER_WRITE=true

# 2. Run readiness check
npm run live:readiness

# 3. Execute revenue/payout cycle
npm run emit:revenue

# 4. Monitor
npm run monitor:once
```

### **Kill Switches (If Something Goes Wrong)**
```bash
set SWARM_LIVE=false
# OR
set BASE44_ENABLE_PAYOUT_LEDGER_WRITE=false
# OR
remove PAYPAL_CLIENT_ID/SECRET
```

### **Recommended Payout Rail for Morocco**
1. **Primary**: Bank wire CSV export → manual bank transfer
2. **Secondary**: Payoneer CSV export
3. **Tertiary**: PayPal Payouts API (if account approved)

### **Next 24-Hour Actions**
1. Run truth export to confirm current state
2. Set up webhook tunnel and configure PayPal
3. Execute small test payout (< $100) with real credentials
4. Update Base44 UI to read from ledger truth source

---

## **SUMMARY**
The system is **technically ready** for live payouts but requires:
1. **Credentials** (PayPal/Bank)
2. **Webhook configuration**
3. **UI truth-source alignment**
4. **One live test transaction**

Execute verification commands first, then proceed with live enablement using the provided scripts and gates.

---

